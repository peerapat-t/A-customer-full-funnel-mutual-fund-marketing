{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "cd934bc7-e425-43e5-8460-1e170070d309",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "from sklearn.datasets import make_blobs\n",
    "import pandas as pd\n",
    "import numpy as np"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "ed5a9460-8dec-4989-b314-12afd026414b",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "# 1. sign up prediction"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "fdc62113-97d7-4498-9d04-4f3e96c53ddf",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "#  1   pages_visited      100000 non-null  int\n",
    "#  2   clicks             100000 non-null  int\n",
    "#  3   features_explored  100000 non-null  int\n",
    "#  4   signup_offer_used  100000 non-null  int\n",
    "#  5   referral_flag      100000 non-null  int\n",
    "#  6   video_views        100000 non-null  int\n",
    "#  7   forms_completed    100000 non-null  int\n",
    "#  8   likes_given        100000 non-null  int\n",
    "#  9   search_queries     100000 non-null  int\n",
    "#  10  scroll_depth       100000 non-null  int\n",
    "#  11  age                100000 non-null  int\n",
    "#  12  income             100000 non-null  float64\n",
    "#  13  location           100000 non-null  int\n",
    "#  14  time_of_day        100000 non-null  int\n",
    "#  15  device_type        100000 non-null  int\n",
    "#  16  signup_flag        100000 non-null  int"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "da0f5ba2-88c8-4520-97e9-f1d90b8924f9",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "centers_signup_adjusted = [\n",
    "    [100, 100, 100, 200, 100, 500, 100, 100, 300, 1200, 50, 60000, 0, 0, 0],  # Group with signup_flag = 1\n",
    "    [50, 30, 40, 50, 30, 30, 50, 60, 50, 600, 20, 120000, 0, 0, 0]           # Group with signup_flag = 0\n",
    "]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "46120b95-6b13-4bec-9583-7b4dde8d645a",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "n_samples = 100000\n",
    "n_features = len(centers_signup_adjusted[0])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "463a3601-7143-4c40-99c0-47d625c8c49d",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "X, y = make_blobs(n_samples=n_samples, centers=centers_signup_adjusted, cluster_std=30, n_features=n_features, random_state=42)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "2446f8ff-1c40-4754-a7ac-6f1affb271cd",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "columns = [\n",
    "    \"pages_visited\", \"clicks\", \"features_explored\", \"signup_offer_used\", \"referral_flag\",\n",
    "    \"video_views\", \"forms_completed\", \"likes_given\", \"search_queries\", \"scroll_depth\",\n",
    "    \"age\", \"income\", \"location\", \"time_of_day\", \"device_type\"\n",
    "]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "dda9778f-5521-4c02-b68b-61f1397ab53f",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "df1 = pd.DataFrame(X, columns=columns)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "0afa63dd-9029-4a07-b1e6-68c73d271b45",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "df1['signup_flag'] = y"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "6abe05a9-d6ac-4fae-bbd6-909810c0ff62",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "int_columns = [\n",
    "    \"pages_visited\", \"clicks\", \"features_explored\", \"signup_offer_used\", \"referral_flag\",\n",
    "    \"video_views\", \"forms_completed\", \"likes_given\", \"search_queries\", \"scroll_depth\",\n",
    "    \"age\", \"location\", \"time_of_day\", \"device_type\"\n",
    "]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "3da5d1db-1dc0-4b9a-ab4c-ad94b69b24b9",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "df1[int_columns] = df1[int_columns].round(0).astype(int)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "d30ca6d4-613b-47e3-b542-4dee57131c04",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>pages_visited</th>\n",
       "      <th>clicks</th>\n",
       "      <th>features_explored</th>\n",
       "      <th>signup_offer_used</th>\n",
       "      <th>referral_flag</th>\n",
       "      <th>video_views</th>\n",
       "      <th>forms_completed</th>\n",
       "      <th>likes_given</th>\n",
       "      <th>search_queries</th>\n",
       "      <th>scroll_depth</th>\n",
       "      <th>age</th>\n",
       "      <th>income</th>\n",
       "      <th>location</th>\n",
       "      <th>time_of_day</th>\n",
       "      <th>device_type</th>\n",
       "      <th>signup_flag</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>127</td>\n",
       "      <td>79</td>\n",
       "      <td>122</td>\n",
       "      <td>224</td>\n",
       "      <td>104</td>\n",
       "      <td>567</td>\n",
       "      <td>122</td>\n",
       "      <td>76</td>\n",
       "      <td>272</td>\n",
       "      <td>1217</td>\n",
       "      <td>39</td>\n",
       "      <td>60014.204028</td>\n",
       "      <td>-49</td>\n",
       "      <td>-24</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>140</td>\n",
       "      <td>135</td>\n",
       "      <td>54</td>\n",
       "      <td>184</td>\n",
       "      <td>105</td>\n",
       "      <td>519</td>\n",
       "      <td>106</td>\n",
       "      <td>123</td>\n",
       "      <td>275</td>\n",
       "      <td>1243</td>\n",
       "      <td>29</td>\n",
       "      <td>59974.401578</td>\n",
       "      <td>17</td>\n",
       "      <td>-37</td>\n",
       "      <td>-5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>141</td>\n",
       "      <td>114</td>\n",
       "      <td>129</td>\n",
       "      <td>137</td>\n",
       "      <td>75</td>\n",
       "      <td>505</td>\n",
       "      <td>70</td>\n",
       "      <td>109</td>\n",
       "      <td>302</td>\n",
       "      <td>1191</td>\n",
       "      <td>69</td>\n",
       "      <td>60012.114118</td>\n",
       "      <td>-19</td>\n",
       "      <td>-5</td>\n",
       "      <td>-33</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>15</td>\n",
       "      <td>23</td>\n",
       "      <td>39</td>\n",
       "      <td>85</td>\n",
       "      <td>3</td>\n",
       "      <td>52</td>\n",
       "      <td>78</td>\n",
       "      <td>64</td>\n",
       "      <td>117</td>\n",
       "      <td>563</td>\n",
       "      <td>8</td>\n",
       "      <td>119979.257741</td>\n",
       "      <td>-2</td>\n",
       "      <td>-4</td>\n",
       "      <td>54</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>58</td>\n",
       "      <td>119</td>\n",
       "      <td>163</td>\n",
       "      <td>206</td>\n",
       "      <td>65</td>\n",
       "      <td>525</td>\n",
       "      <td>90</td>\n",
       "      <td>105</td>\n",
       "      <td>292</td>\n",
       "      <td>1209</td>\n",
       "      <td>80</td>\n",
       "      <td>60002.659923</td>\n",
       "      <td>0</td>\n",
       "      <td>-2</td>\n",
       "      <td>44</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   pages_visited  clicks  features_explored  signup_offer_used  referral_flag  \\\n",
       "0            127      79                122                224            104   \n",
       "1            140     135                 54                184            105   \n",
       "2            141     114                129                137             75   \n",
       "3             15      23                 39                 85              3   \n",
       "4             58     119                163                206             65   \n",
       "\n",
       "   video_views  forms_completed  likes_given  search_queries  scroll_depth  \\\n",
       "0          567              122           76             272          1217   \n",
       "1          519              106          123             275          1243   \n",
       "2          505               70          109             302          1191   \n",
       "3           52               78           64             117           563   \n",
       "4          525               90          105             292          1209   \n",
       "\n",
       "   age         income  location  time_of_day  device_type  signup_flag  \n",
       "0   39   60014.204028       -49          -24            4            0  \n",
       "1   29   59974.401578        17          -37           -5            0  \n",
       "2   69   60012.114118       -19           -5          -33            0  \n",
       "3    8  119979.257741        -2           -4           54            1  \n",
       "4   80   60002.659923         0           -2           44            0  "
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df1.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "3521381e-d96e-481f-9952-1e94c1e432c9",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "location_values = ['urban', 'suburban', 'rural']\n",
    "time_of_day_values = ['afternoon', 'evening', 'night', 'morning']\n",
    "device_type_values = ['mobile', 'tablet', 'desktop']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "adbb02a6-76d5-49fb-99c8-2776a50761b2",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "df1['location'] = np.random.choice(location_values, size=len(df1))\n",
    "df1['time_of_day'] = np.random.choice(time_of_day_values, size=len(df1))\n",
    "df1['device_type'] = np.random.choice(device_type_values, size=len(df1))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "9d0eff1a-7e80-4f04-8693-e5325be83989",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>pages_visited</th>\n",
       "      <th>clicks</th>\n",
       "      <th>features_explored</th>\n",
       "      <th>signup_offer_used</th>\n",
       "      <th>referral_flag</th>\n",
       "      <th>video_views</th>\n",
       "      <th>forms_completed</th>\n",
       "      <th>likes_given</th>\n",
       "      <th>search_queries</th>\n",
       "      <th>scroll_depth</th>\n",
       "      <th>age</th>\n",
       "      <th>income</th>\n",
       "      <th>location</th>\n",
       "      <th>time_of_day</th>\n",
       "      <th>device_type</th>\n",
       "      <th>signup_flag</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>127</td>\n",
       "      <td>79</td>\n",
       "      <td>122</td>\n",
       "      <td>224</td>\n",
       "      <td>104</td>\n",
       "      <td>567</td>\n",
       "      <td>122</td>\n",
       "      <td>76</td>\n",
       "      <td>272</td>\n",
       "      <td>1217</td>\n",
       "      <td>39</td>\n",
       "      <td>60014.204028</td>\n",
       "      <td>suburban</td>\n",
       "      <td>afternoon</td>\n",
       "      <td>desktop</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>140</td>\n",
       "      <td>135</td>\n",
       "      <td>54</td>\n",
       "      <td>184</td>\n",
       "      <td>105</td>\n",
       "      <td>519</td>\n",
       "      <td>106</td>\n",
       "      <td>123</td>\n",
       "      <td>275</td>\n",
       "      <td>1243</td>\n",
       "      <td>29</td>\n",
       "      <td>59974.401578</td>\n",
       "      <td>rural</td>\n",
       "      <td>morning</td>\n",
       "      <td>mobile</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>141</td>\n",
       "      <td>114</td>\n",
       "      <td>129</td>\n",
       "      <td>137</td>\n",
       "      <td>75</td>\n",
       "      <td>505</td>\n",
       "      <td>70</td>\n",
       "      <td>109</td>\n",
       "      <td>302</td>\n",
       "      <td>1191</td>\n",
       "      <td>69</td>\n",
       "      <td>60012.114118</td>\n",
       "      <td>urban</td>\n",
       "      <td>afternoon</td>\n",
       "      <td>tablet</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>15</td>\n",
       "      <td>23</td>\n",
       "      <td>39</td>\n",
       "      <td>85</td>\n",
       "      <td>3</td>\n",
       "      <td>52</td>\n",
       "      <td>78</td>\n",
       "      <td>64</td>\n",
       "      <td>117</td>\n",
       "      <td>563</td>\n",
       "      <td>8</td>\n",
       "      <td>119979.257741</td>\n",
       "      <td>suburban</td>\n",
       "      <td>evening</td>\n",
       "      <td>mobile</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>58</td>\n",
       "      <td>119</td>\n",
       "      <td>163</td>\n",
       "      <td>206</td>\n",
       "      <td>65</td>\n",
       "      <td>525</td>\n",
       "      <td>90</td>\n",
       "      <td>105</td>\n",
       "      <td>292</td>\n",
       "      <td>1209</td>\n",
       "      <td>80</td>\n",
       "      <td>60002.659923</td>\n",
       "      <td>urban</td>\n",
       "      <td>morning</td>\n",
       "      <td>desktop</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   pages_visited  clicks  features_explored  signup_offer_used  referral_flag  \\\n",
       "0            127      79                122                224            104   \n",
       "1            140     135                 54                184            105   \n",
       "2            141     114                129                137             75   \n",
       "3             15      23                 39                 85              3   \n",
       "4             58     119                163                206             65   \n",
       "\n",
       "   video_views  forms_completed  likes_given  search_queries  scroll_depth  \\\n",
       "0          567              122           76             272          1217   \n",
       "1          519              106          123             275          1243   \n",
       "2          505               70          109             302          1191   \n",
       "3           52               78           64             117           563   \n",
       "4          525               90          105             292          1209   \n",
       "\n",
       "   age         income  location time_of_day device_type  signup_flag  \n",
       "0   39   60014.204028  suburban   afternoon     desktop            0  \n",
       "1   29   59974.401578     rural     morning      mobile            0  \n",
       "2   69   60012.114118     urban   afternoon      tablet            0  \n",
       "3    8  119979.257741  suburban     evening      mobile            1  \n",
       "4   80   60002.659923     urban     morning     desktop            0  "
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df1.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "b1a52d4f",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>pages_visited</th>\n",
       "      <th>clicks</th>\n",
       "      <th>features_explored</th>\n",
       "      <th>signup_offer_used</th>\n",
       "      <th>referral_flag</th>\n",
       "      <th>video_views</th>\n",
       "      <th>forms_completed</th>\n",
       "      <th>likes_given</th>\n",
       "      <th>search_queries</th>\n",
       "      <th>scroll_depth</th>\n",
       "      <th>age</th>\n",
       "      <th>income</th>\n",
       "      <th>signup_flag</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>100000.000000</td>\n",
       "      <td>100000.000000</td>\n",
       "      <td>100000.000000</td>\n",
       "      <td>100000.000000</td>\n",
       "      <td>100000.000000</td>\n",
       "      <td>100000.000000</td>\n",
       "      <td>100000.000000</td>\n",
       "      <td>100000.000000</td>\n",
       "      <td>100000.000000</td>\n",
       "      <td>100000.000000</td>\n",
       "      <td>100000.000000</td>\n",
       "      <td>100000.000000</td>\n",
       "      <td>100000.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>75.022500</td>\n",
       "      <td>65.055990</td>\n",
       "      <td>69.887520</td>\n",
       "      <td>124.909390</td>\n",
       "      <td>64.980220</td>\n",
       "      <td>264.947610</td>\n",
       "      <td>75.112280</td>\n",
       "      <td>79.656240</td>\n",
       "      <td>174.934690</td>\n",
       "      <td>900.061600</td>\n",
       "      <td>35.020720</td>\n",
       "      <td>89999.903012</td>\n",
       "      <td>0.500000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>39.108804</td>\n",
       "      <td>46.139723</td>\n",
       "      <td>42.493691</td>\n",
       "      <td>80.810506</td>\n",
       "      <td>46.083509</td>\n",
       "      <td>236.825817</td>\n",
       "      <td>39.064801</td>\n",
       "      <td>36.139461</td>\n",
       "      <td>128.438002</td>\n",
       "      <td>301.619637</td>\n",
       "      <td>33.605983</td>\n",
       "      <td>30000.111148</td>\n",
       "      <td>0.500003</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>-69.000000</td>\n",
       "      <td>-94.000000</td>\n",
       "      <td>-80.000000</td>\n",
       "      <td>-72.000000</td>\n",
       "      <td>-92.000000</td>\n",
       "      <td>-99.000000</td>\n",
       "      <td>-79.000000</td>\n",
       "      <td>-53.000000</td>\n",
       "      <td>-89.000000</td>\n",
       "      <td>476.000000</td>\n",
       "      <td>-105.000000</td>\n",
       "      <td>59871.507400</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>47.000000</td>\n",
       "      <td>29.000000</td>\n",
       "      <td>38.000000</td>\n",
       "      <td>50.000000</td>\n",
       "      <td>29.000000</td>\n",
       "      <td>30.000000</td>\n",
       "      <td>47.000000</td>\n",
       "      <td>55.000000</td>\n",
       "      <td>50.000000</td>\n",
       "      <td>600.000000</td>\n",
       "      <td>12.000000</td>\n",
       "      <td>60000.157614</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>75.000000</td>\n",
       "      <td>65.000000</td>\n",
       "      <td>70.000000</td>\n",
       "      <td>125.000000</td>\n",
       "      <td>65.000000</td>\n",
       "      <td>267.000000</td>\n",
       "      <td>75.000000</td>\n",
       "      <td>80.000000</td>\n",
       "      <td>169.500000</td>\n",
       "      <td>898.000000</td>\n",
       "      <td>35.000000</td>\n",
       "      <td>90004.343360</td>\n",
       "      <td>0.500000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>103.000000</td>\n",
       "      <td>101.000000</td>\n",
       "      <td>102.000000</td>\n",
       "      <td>200.000000</td>\n",
       "      <td>101.000000</td>\n",
       "      <td>500.000000</td>\n",
       "      <td>103.000000</td>\n",
       "      <td>105.000000</td>\n",
       "      <td>300.000000</td>\n",
       "      <td>1200.000000</td>\n",
       "      <td>58.000000</td>\n",
       "      <td>119999.822871</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>218.000000</td>\n",
       "      <td>238.000000</td>\n",
       "      <td>229.000000</td>\n",
       "      <td>334.000000</td>\n",
       "      <td>236.000000</td>\n",
       "      <td>622.000000</td>\n",
       "      <td>229.000000</td>\n",
       "      <td>240.000000</td>\n",
       "      <td>417.000000</td>\n",
       "      <td>1326.000000</td>\n",
       "      <td>166.000000</td>\n",
       "      <td>120118.268922</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       pages_visited         clicks  features_explored  signup_offer_used  \\\n",
       "count  100000.000000  100000.000000      100000.000000      100000.000000   \n",
       "mean       75.022500      65.055990          69.887520         124.909390   \n",
       "std        39.108804      46.139723          42.493691          80.810506   \n",
       "min       -69.000000     -94.000000         -80.000000         -72.000000   \n",
       "25%        47.000000      29.000000          38.000000          50.000000   \n",
       "50%        75.000000      65.000000          70.000000         125.000000   \n",
       "75%       103.000000     101.000000         102.000000         200.000000   \n",
       "max       218.000000     238.000000         229.000000         334.000000   \n",
       "\n",
       "       referral_flag    video_views  forms_completed    likes_given  \\\n",
       "count  100000.000000  100000.000000    100000.000000  100000.000000   \n",
       "mean       64.980220     264.947610        75.112280      79.656240   \n",
       "std        46.083509     236.825817        39.064801      36.139461   \n",
       "min       -92.000000     -99.000000       -79.000000     -53.000000   \n",
       "25%        29.000000      30.000000        47.000000      55.000000   \n",
       "50%        65.000000     267.000000        75.000000      80.000000   \n",
       "75%       101.000000     500.000000       103.000000     105.000000   \n",
       "max       236.000000     622.000000       229.000000     240.000000   \n",
       "\n",
       "       search_queries   scroll_depth            age         income  \\\n",
       "count   100000.000000  100000.000000  100000.000000  100000.000000   \n",
       "mean       174.934690     900.061600      35.020720   89999.903012   \n",
       "std        128.438002     301.619637      33.605983   30000.111148   \n",
       "min        -89.000000     476.000000    -105.000000   59871.507400   \n",
       "25%         50.000000     600.000000      12.000000   60000.157614   \n",
       "50%        169.500000     898.000000      35.000000   90004.343360   \n",
       "75%        300.000000    1200.000000      58.000000  119999.822871   \n",
       "max        417.000000    1326.000000     166.000000  120118.268922   \n",
       "\n",
       "         signup_flag  \n",
       "count  100000.000000  \n",
       "mean        0.500000  \n",
       "std         0.500003  \n",
       "min         0.000000  \n",
       "25%         0.000000  \n",
       "50%         0.500000  \n",
       "75%         1.000000  \n",
       "max         1.000000  "
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df1.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7db1052c-73a9-4f8a-b17e-d5cfc23a1ef9",
   "metadata": {},
   "outputs": [],
   "source": [
    "*"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "5f8b16ee",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "# 2. segmentation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "dba0c45e-77ae-407c-98a9-db05c66ec387",
   "metadata": {},
   "outputs": [],
   "source": [
    "centroids = [\n",
    "    [50000, 15, 5, 10, 2, 1000000, 20, 30, 25, 35, 50, 0, 0, 0, 0, 5, 30, 70, 3],   # Conservative investors\n",
    "    [1500000, 5, 15, 30, 1, 8000000, 30, 20, 40, 10, 25, 1, 1, 1, 1, 9, 60, 40, 8],  # High-risk investors\n",
    "    [500000, 10, 10, 20, 1.5, 4000000, 25, 25, 30, 20, 35, 1, 1, 1, 1, 7, 50, 50, 6], # Balanced investors\n",
    "    [200000, 20, 7, 15, 1.8, 2000000, 15, 35, 20, 40, 45, 0, 0, 0, 0, 6, 40, 60, 4],  # Low-risk investors\n",
    "    [800000, 8, 12, 25, 1.2, 6000000, 28, 28, 35, 25, 30, 1, 1, 1, 1, 8, 55, 45, 7],  # Growth-focused investors\n",
    "    [1000000, 12, 8, 18, 1.7, 5000000, 22, 22, 28, 22, 40, 0, 0, 0, 0, 7, 48, 52, 5],  # Moderate-risk investors\n",
    "]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "0ae79ef1-d292-48b1-866b-4682edaa680d",
   "metadata": {},
   "outputs": [],
   "source": [
    "n_samples = 100000\n",
    "n_features = len(centroids[0])\n",
    "n_clusters = len(centroids)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "76e0f91f-d458-42a8-8254-b2f84057a5b7",
   "metadata": {},
   "outputs": [],
   "source": [
    "X, y = make_blobs(n_samples=n_samples, centers=centroids, n_features=n_features, random_state=42)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "a53e1cc9-1c81-467a-822d-1ee238361f1d",
   "metadata": {},
   "outputs": [],
   "source": [
    "feature_names = [\n",
    "    \"Total_Investment\", \"Investment_Tenure\", \"Average_Return\", \"Portfolio_Volatility\",\n",
    "    \"Expense_Ratio\", \"Fund_Size\", \"Sector_Allocation_Tech\", \"Sector_Allocation_Healthcare\",\n",
    "    \"Sector_Allocation_Finance\", \"Sector_Allocation_RealEstate\", \"Transaction_Frequency\",\n",
    "    \"Risk_Appetite_Flag\", \"Redemption_Frequency_Flag\", \"Preferred_Equity_Flag\",\n",
    "    \"Preferred_Debt_Flag\", \"Diversification_Index\", \"Top_3_Fund_Concentration\",\n",
    "    \"Remaining_Fund_Allocation\", \"Average_Holding_Period\"\n",
    "]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "b04d85e5-d957-442a-b12e-19c078647bfd",
   "metadata": {},
   "outputs": [],
   "source": [
    "df2 = pd.DataFrame(X, columns=feature_names)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "32ce063b-07e6-438f-9b20-5f36cf0c1577",
   "metadata": {},
   "outputs": [],
   "source": [
    "df2[\"Cluster\"] = y"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "1d99a0d7-d278-44c2-a7d2-b3d0e848d2f1",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "int_columns = [\n",
    "    \"Fund_Size\", \"Sector_Allocation_Tech\", \n",
    "    \"Sector_Allocation_Healthcare\", \"Sector_Allocation_Finance\",\n",
    "    \"Sector_Allocation_RealEstate\", \"Transaction_Frequency\",\n",
    "    \"Top_3_Fund_Concentration\", \"Remaining_Fund_Allocation\", \n",
    "    \"Average_Holding_Period\"\n",
    "]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "70030170-3759-41f2-a1fe-059b087a1c11",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "df2[int_columns] = df2[int_columns].round(0).astype(int)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "9d726568-5528-41ce-aa5b-9b8bd2c204c5",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Total_Investment</th>\n",
       "      <th>Investment_Tenure</th>\n",
       "      <th>Average_Return</th>\n",
       "      <th>Portfolio_Volatility</th>\n",
       "      <th>Expense_Ratio</th>\n",
       "      <th>Fund_Size</th>\n",
       "      <th>Sector_Allocation_Tech</th>\n",
       "      <th>Sector_Allocation_Healthcare</th>\n",
       "      <th>Sector_Allocation_Finance</th>\n",
       "      <th>Sector_Allocation_RealEstate</th>\n",
       "      <th>Transaction_Frequency</th>\n",
       "      <th>Risk_Appetite_Flag</th>\n",
       "      <th>Redemption_Frequency_Flag</th>\n",
       "      <th>Preferred_Equity_Flag</th>\n",
       "      <th>Preferred_Debt_Flag</th>\n",
       "      <th>Diversification_Index</th>\n",
       "      <th>Top_3_Fund_Concentration</th>\n",
       "      <th>Remaining_Fund_Allocation</th>\n",
       "      <th>Average_Holding_Period</th>\n",
       "      <th>Cluster</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>4.999865e+04</td>\n",
       "      <td>15.315932</td>\n",
       "      <td>4.173330</td>\n",
       "      <td>9.189205</td>\n",
       "      <td>3.075631</td>\n",
       "      <td>999999</td>\n",
       "      <td>20</td>\n",
       "      <td>30</td>\n",
       "      <td>23</td>\n",
       "      <td>36</td>\n",
       "      <td>50</td>\n",
       "      <td>0.010323</td>\n",
       "      <td>0.404233</td>\n",
       "      <td>0.781260</td>\n",
       "      <td>-0.777639</td>\n",
       "      <td>6.398412</td>\n",
       "      <td>32</td>\n",
       "      <td>71</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>5.000154e+04</td>\n",
       "      <td>14.287971</td>\n",
       "      <td>5.512258</td>\n",
       "      <td>11.830510</td>\n",
       "      <td>2.239912</td>\n",
       "      <td>1000001</td>\n",
       "      <td>18</td>\n",
       "      <td>30</td>\n",
       "      <td>25</td>\n",
       "      <td>36</td>\n",
       "      <td>48</td>\n",
       "      <td>1.058243</td>\n",
       "      <td>-2.061865</td>\n",
       "      <td>0.467551</td>\n",
       "      <td>-0.196888</td>\n",
       "      <td>4.818366</td>\n",
       "      <td>31</td>\n",
       "      <td>71</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>5.000000e+05</td>\n",
       "      <td>9.527812</td>\n",
       "      <td>9.541177</td>\n",
       "      <td>19.551317</td>\n",
       "      <td>-0.263416</td>\n",
       "      <td>4000001</td>\n",
       "      <td>25</td>\n",
       "      <td>25</td>\n",
       "      <td>31</td>\n",
       "      <td>19</td>\n",
       "      <td>34</td>\n",
       "      <td>1.065188</td>\n",
       "      <td>0.357297</td>\n",
       "      <td>2.551688</td>\n",
       "      <td>-0.120348</td>\n",
       "      <td>7.361012</td>\n",
       "      <td>50</td>\n",
       "      <td>50</td>\n",
       "      <td>7</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>5.000000e+05</td>\n",
       "      <td>10.511943</td>\n",
       "      <td>12.002886</td>\n",
       "      <td>20.558868</td>\n",
       "      <td>0.123055</td>\n",
       "      <td>4000000</td>\n",
       "      <td>25</td>\n",
       "      <td>23</td>\n",
       "      <td>31</td>\n",
       "      <td>20</td>\n",
       "      <td>35</td>\n",
       "      <td>0.032408</td>\n",
       "      <td>-0.860613</td>\n",
       "      <td>1.146066</td>\n",
       "      <td>0.583275</td>\n",
       "      <td>5.779051</td>\n",
       "      <td>51</td>\n",
       "      <td>51</td>\n",
       "      <td>7</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1.500000e+06</td>\n",
       "      <td>5.329810</td>\n",
       "      <td>15.161704</td>\n",
       "      <td>32.233247</td>\n",
       "      <td>1.107555</td>\n",
       "      <td>8000000</td>\n",
       "      <td>31</td>\n",
       "      <td>20</td>\n",
       "      <td>38</td>\n",
       "      <td>9</td>\n",
       "      <td>25</td>\n",
       "      <td>1.747584</td>\n",
       "      <td>1.493297</td>\n",
       "      <td>1.389152</td>\n",
       "      <td>0.993521</td>\n",
       "      <td>7.514665</td>\n",
       "      <td>59</td>\n",
       "      <td>41</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Total_Investment  Investment_Tenure  Average_Return  Portfolio_Volatility  \\\n",
       "0      4.999865e+04          15.315932        4.173330              9.189205   \n",
       "1      5.000154e+04          14.287971        5.512258             11.830510   \n",
       "2      5.000000e+05           9.527812        9.541177             19.551317   \n",
       "3      5.000000e+05          10.511943       12.002886             20.558868   \n",
       "4      1.500000e+06           5.329810       15.161704             32.233247   \n",
       "\n",
       "   Expense_Ratio  Fund_Size  Sector_Allocation_Tech  \\\n",
       "0       3.075631     999999                      20   \n",
       "1       2.239912    1000001                      18   \n",
       "2      -0.263416    4000001                      25   \n",
       "3       0.123055    4000000                      25   \n",
       "4       1.107555    8000000                      31   \n",
       "\n",
       "   Sector_Allocation_Healthcare  Sector_Allocation_Finance  \\\n",
       "0                            30                         23   \n",
       "1                            30                         25   \n",
       "2                            25                         31   \n",
       "3                            23                         31   \n",
       "4                            20                         38   \n",
       "\n",
       "   Sector_Allocation_RealEstate  Transaction_Frequency  Risk_Appetite_Flag  \\\n",
       "0                            36                     50            0.010323   \n",
       "1                            36                     48            1.058243   \n",
       "2                            19                     34            1.065188   \n",
       "3                            20                     35            0.032408   \n",
       "4                             9                     25            1.747584   \n",
       "\n",
       "   Redemption_Frequency_Flag  Preferred_Equity_Flag  Preferred_Debt_Flag  \\\n",
       "0                   0.404233               0.781260            -0.777639   \n",
       "1                  -2.061865               0.467551            -0.196888   \n",
       "2                   0.357297               2.551688            -0.120348   \n",
       "3                  -0.860613               1.146066             0.583275   \n",
       "4                   1.493297               1.389152             0.993521   \n",
       "\n",
       "   Diversification_Index  Top_3_Fund_Concentration  Remaining_Fund_Allocation  \\\n",
       "0               6.398412                        32                         71   \n",
       "1               4.818366                        31                         71   \n",
       "2               7.361012                        50                         50   \n",
       "3               5.779051                        51                         51   \n",
       "4               7.514665                        59                         41   \n",
       "\n",
       "   Average_Holding_Period  Cluster  \n",
       "0                       5        0  \n",
       "1                       4        0  \n",
       "2                       7        2  \n",
       "3                       7        2  \n",
       "4                       9        1  "
      ]
     },
     "execution_count": 45,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df2.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "03ba4b0b-5012-44f9-82e4-b65b21b60c8c",
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "df2[\"customer_id\"] = range(1, len(df2) + 1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "520395ec-eec2-4a2c-9750-5d8773477fba",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Total_Investment</th>\n",
       "      <th>Investment_Tenure</th>\n",
       "      <th>Average_Return</th>\n",
       "      <th>Portfolio_Volatility</th>\n",
       "      <th>Expense_Ratio</th>\n",
       "      <th>Fund_Size</th>\n",
       "      <th>Sector_Allocation_Tech</th>\n",
       "      <th>Sector_Allocation_Healthcare</th>\n",
       "      <th>Sector_Allocation_Finance</th>\n",
       "      <th>Sector_Allocation_RealEstate</th>\n",
       "      <th>...</th>\n",
       "      <th>Risk_Appetite_Flag</th>\n",
       "      <th>Redemption_Frequency_Flag</th>\n",
       "      <th>Preferred_Equity_Flag</th>\n",
       "      <th>Preferred_Debt_Flag</th>\n",
       "      <th>Diversification_Index</th>\n",
       "      <th>Top_3_Fund_Concentration</th>\n",
       "      <th>Remaining_Fund_Allocation</th>\n",
       "      <th>Average_Holding_Period</th>\n",
       "      <th>Cluster</th>\n",
       "      <th>Customer_ID</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>4.999865e+04</td>\n",
       "      <td>15.315932</td>\n",
       "      <td>4.173330</td>\n",
       "      <td>9.189205</td>\n",
       "      <td>3.075631</td>\n",
       "      <td>999999</td>\n",
       "      <td>20</td>\n",
       "      <td>30</td>\n",
       "      <td>23</td>\n",
       "      <td>36</td>\n",
       "      <td>...</td>\n",
       "      <td>0.010323</td>\n",
       "      <td>0.404233</td>\n",
       "      <td>0.781260</td>\n",
       "      <td>-0.777639</td>\n",
       "      <td>6.398412</td>\n",
       "      <td>32</td>\n",
       "      <td>71</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>5.000154e+04</td>\n",
       "      <td>14.287971</td>\n",
       "      <td>5.512258</td>\n",
       "      <td>11.830510</td>\n",
       "      <td>2.239912</td>\n",
       "      <td>1000001</td>\n",
       "      <td>18</td>\n",
       "      <td>30</td>\n",
       "      <td>25</td>\n",
       "      <td>36</td>\n",
       "      <td>...</td>\n",
       "      <td>1.058243</td>\n",
       "      <td>-2.061865</td>\n",
       "      <td>0.467551</td>\n",
       "      <td>-0.196888</td>\n",
       "      <td>4.818366</td>\n",
       "      <td>31</td>\n",
       "      <td>71</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>5.000000e+05</td>\n",
       "      <td>9.527812</td>\n",
       "      <td>9.541177</td>\n",
       "      <td>19.551317</td>\n",
       "      <td>-0.263416</td>\n",
       "      <td>4000001</td>\n",
       "      <td>25</td>\n",
       "      <td>25</td>\n",
       "      <td>31</td>\n",
       "      <td>19</td>\n",
       "      <td>...</td>\n",
       "      <td>1.065188</td>\n",
       "      <td>0.357297</td>\n",
       "      <td>2.551688</td>\n",
       "      <td>-0.120348</td>\n",
       "      <td>7.361012</td>\n",
       "      <td>50</td>\n",
       "      <td>50</td>\n",
       "      <td>7</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>5.000000e+05</td>\n",
       "      <td>10.511943</td>\n",
       "      <td>12.002886</td>\n",
       "      <td>20.558868</td>\n",
       "      <td>0.123055</td>\n",
       "      <td>4000000</td>\n",
       "      <td>25</td>\n",
       "      <td>23</td>\n",
       "      <td>31</td>\n",
       "      <td>20</td>\n",
       "      <td>...</td>\n",
       "      <td>0.032408</td>\n",
       "      <td>-0.860613</td>\n",
       "      <td>1.146066</td>\n",
       "      <td>0.583275</td>\n",
       "      <td>5.779051</td>\n",
       "      <td>51</td>\n",
       "      <td>51</td>\n",
       "      <td>7</td>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1.500000e+06</td>\n",
       "      <td>5.329810</td>\n",
       "      <td>15.161704</td>\n",
       "      <td>32.233247</td>\n",
       "      <td>1.107555</td>\n",
       "      <td>8000000</td>\n",
       "      <td>31</td>\n",
       "      <td>20</td>\n",
       "      <td>38</td>\n",
       "      <td>9</td>\n",
       "      <td>...</td>\n",
       "      <td>1.747584</td>\n",
       "      <td>1.493297</td>\n",
       "      <td>1.389152</td>\n",
       "      <td>0.993521</td>\n",
       "      <td>7.514665</td>\n",
       "      <td>59</td>\n",
       "      <td>41</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows Ã— 21 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   Total_Investment  Investment_Tenure  Average_Return  Portfolio_Volatility  \\\n",
       "0      4.999865e+04          15.315932        4.173330              9.189205   \n",
       "1      5.000154e+04          14.287971        5.512258             11.830510   \n",
       "2      5.000000e+05           9.527812        9.541177             19.551317   \n",
       "3      5.000000e+05          10.511943       12.002886             20.558868   \n",
       "4      1.500000e+06           5.329810       15.161704             32.233247   \n",
       "\n",
       "   Expense_Ratio  Fund_Size  Sector_Allocation_Tech  \\\n",
       "0       3.075631     999999                      20   \n",
       "1       2.239912    1000001                      18   \n",
       "2      -0.263416    4000001                      25   \n",
       "3       0.123055    4000000                      25   \n",
       "4       1.107555    8000000                      31   \n",
       "\n",
       "   Sector_Allocation_Healthcare  Sector_Allocation_Finance  \\\n",
       "0                            30                         23   \n",
       "1                            30                         25   \n",
       "2                            25                         31   \n",
       "3                            23                         31   \n",
       "4                            20                         38   \n",
       "\n",
       "   Sector_Allocation_RealEstate  ...  Risk_Appetite_Flag  \\\n",
       "0                            36  ...            0.010323   \n",
       "1                            36  ...            1.058243   \n",
       "2                            19  ...            1.065188   \n",
       "3                            20  ...            0.032408   \n",
       "4                             9  ...            1.747584   \n",
       "\n",
       "   Redemption_Frequency_Flag  Preferred_Equity_Flag  Preferred_Debt_Flag  \\\n",
       "0                   0.404233               0.781260            -0.777639   \n",
       "1                  -2.061865               0.467551            -0.196888   \n",
       "2                   0.357297               2.551688            -0.120348   \n",
       "3                  -0.860613               1.146066             0.583275   \n",
       "4                   1.493297               1.389152             0.993521   \n",
       "\n",
       "   Diversification_Index  Top_3_Fund_Concentration  Remaining_Fund_Allocation  \\\n",
       "0               6.398412                        32                         71   \n",
       "1               4.818366                        31                         71   \n",
       "2               7.361012                        50                         50   \n",
       "3               5.779051                        51                         51   \n",
       "4               7.514665                        59                         41   \n",
       "\n",
       "   Average_Holding_Period  Cluster  Customer_ID  \n",
       "0                       5        0            1  \n",
       "1                       4        0            2  \n",
       "2                       7        2            3  \n",
       "3                       7        2            4  \n",
       "4                       9        1            5  \n",
       "\n",
       "[5 rows x 21 columns]"
      ]
     },
     "execution_count": 49,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df2.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "5ca5d1e7-4abf-474d-8e24-61ea51a36d12",
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Total_Investment</th>\n",
       "      <th>Investment_Tenure</th>\n",
       "      <th>Average_Return</th>\n",
       "      <th>Portfolio_Volatility</th>\n",
       "      <th>Expense_Ratio</th>\n",
       "      <th>Fund_Size</th>\n",
       "      <th>Sector_Allocation_Tech</th>\n",
       "      <th>Sector_Allocation_Healthcare</th>\n",
       "      <th>Sector_Allocation_Finance</th>\n",
       "      <th>Sector_Allocation_RealEstate</th>\n",
       "      <th>...</th>\n",
       "      <th>Risk_Appetite_Flag</th>\n",
       "      <th>Redemption_Frequency_Flag</th>\n",
       "      <th>Preferred_Equity_Flag</th>\n",
       "      <th>Preferred_Debt_Flag</th>\n",
       "      <th>Diversification_Index</th>\n",
       "      <th>Top_3_Fund_Concentration</th>\n",
       "      <th>Remaining_Fund_Allocation</th>\n",
       "      <th>Average_Holding_Period</th>\n",
       "      <th>Cluster</th>\n",
       "      <th>Customer_ID</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>1.000000e+05</td>\n",
       "      <td>100000.000000</td>\n",
       "      <td>100000.000000</td>\n",
       "      <td>100000.000000</td>\n",
       "      <td>100000.000000</td>\n",
       "      <td>1.000000e+05</td>\n",
       "      <td>100000.000000</td>\n",
       "      <td>100000.000000</td>\n",
       "      <td>100000.000000</td>\n",
       "      <td>100000.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>100000.000000</td>\n",
       "      <td>100000.000000</td>\n",
       "      <td>100000.000000</td>\n",
       "      <td>100000.000000</td>\n",
       "      <td>100000.000000</td>\n",
       "      <td>100000.000000</td>\n",
       "      <td>100000.000000</td>\n",
       "      <td>100000.000000</td>\n",
       "      <td>100000.000000</td>\n",
       "      <td>100000.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>6.749955e+05</td>\n",
       "      <td>11.670288</td>\n",
       "      <td>9.495579</td>\n",
       "      <td>19.664768</td>\n",
       "      <td>1.533243</td>\n",
       "      <td>4.333310e+06</td>\n",
       "      <td>23.333890</td>\n",
       "      <td>26.665730</td>\n",
       "      <td>29.661060</td>\n",
       "      <td>25.327220</td>\n",
       "      <td>...</td>\n",
       "      <td>0.491155</td>\n",
       "      <td>0.494095</td>\n",
       "      <td>0.499359</td>\n",
       "      <td>0.502632</td>\n",
       "      <td>7.002951</td>\n",
       "      <td>47.167820</td>\n",
       "      <td>52.833680</td>\n",
       "      <td>5.505300</td>\n",
       "      <td>2.499960</td>\n",
       "      <td>50000.500000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>4.913902e+05</td>\n",
       "      <td>4.955070</td>\n",
       "      <td>3.453512</td>\n",
       "      <td>6.576382</td>\n",
       "      <td>1.058707</td>\n",
       "      <td>2.357051e+06</td>\n",
       "      <td>5.129381</td>\n",
       "      <td>5.130522</td>\n",
       "      <td>6.580104</td>\n",
       "      <td>9.917739</td>\n",
       "      <td>...</td>\n",
       "      <td>1.118873</td>\n",
       "      <td>1.118059</td>\n",
       "      <td>1.120324</td>\n",
       "      <td>1.121465</td>\n",
       "      <td>1.637176</td>\n",
       "      <td>9.897113</td>\n",
       "      <td>9.892496</td>\n",
       "      <td>2.003185</td>\n",
       "      <td>1.707826</td>\n",
       "      <td>28867.657797</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>4.999593e+04</td>\n",
       "      <td>1.341209</td>\n",
       "      <td>1.331471</td>\n",
       "      <td>6.255222</td>\n",
       "      <td>-3.010735</td>\n",
       "      <td>9.999960e+05</td>\n",
       "      <td>11.000000</td>\n",
       "      <td>16.000000</td>\n",
       "      <td>16.000000</td>\n",
       "      <td>6.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>-4.374043</td>\n",
       "      <td>-3.833397</td>\n",
       "      <td>-4.465604</td>\n",
       "      <td>-4.047726</td>\n",
       "      <td>1.197369</td>\n",
       "      <td>26.000000</td>\n",
       "      <td>36.000000</td>\n",
       "      <td>-1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>2.000000e+05</td>\n",
       "      <td>7.945001</td>\n",
       "      <td>6.791964</td>\n",
       "      <td>14.983190</td>\n",
       "      <td>0.818927</td>\n",
       "      <td>2.000000e+06</td>\n",
       "      <td>20.000000</td>\n",
       "      <td>22.000000</td>\n",
       "      <td>25.000000</td>\n",
       "      <td>20.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.273921</td>\n",
       "      <td>-0.267021</td>\n",
       "      <td>-0.266836</td>\n",
       "      <td>-0.263618</td>\n",
       "      <td>5.843732</td>\n",
       "      <td>40.000000</td>\n",
       "      <td>45.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>25000.750000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>5.000039e+05</td>\n",
       "      <td>11.005597</td>\n",
       "      <td>9.028762</td>\n",
       "      <td>19.009733</td>\n",
       "      <td>1.531191</td>\n",
       "      <td>4.000004e+06</td>\n",
       "      <td>23.000000</td>\n",
       "      <td>26.000000</td>\n",
       "      <td>29.000000</td>\n",
       "      <td>23.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.494465</td>\n",
       "      <td>0.497983</td>\n",
       "      <td>0.503598</td>\n",
       "      <td>0.501438</td>\n",
       "      <td>7.009824</td>\n",
       "      <td>49.000000</td>\n",
       "      <td>51.000000</td>\n",
       "      <td>6.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>50000.500000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>1.000000e+06</td>\n",
       "      <td>15.017276</td>\n",
       "      <td>12.039789</td>\n",
       "      <td>25.003204</td>\n",
       "      <td>2.252291</td>\n",
       "      <td>6.000000e+06</td>\n",
       "      <td>28.000000</td>\n",
       "      <td>30.000000</td>\n",
       "      <td>35.000000</td>\n",
       "      <td>35.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>1.257186</td>\n",
       "      <td>1.259966</td>\n",
       "      <td>1.260670</td>\n",
       "      <td>1.265504</td>\n",
       "      <td>8.160929</td>\n",
       "      <td>55.000000</td>\n",
       "      <td>60.000000</td>\n",
       "      <td>7.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>75000.250000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>1.500005e+06</td>\n",
       "      <td>23.870516</td>\n",
       "      <td>18.796238</td>\n",
       "      <td>34.678949</td>\n",
       "      <td>6.202026</td>\n",
       "      <td>8.000004e+06</td>\n",
       "      <td>33.000000</td>\n",
       "      <td>39.000000</td>\n",
       "      <td>44.000000</td>\n",
       "      <td>44.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>5.019419</td>\n",
       "      <td>4.974001</td>\n",
       "      <td>4.979352</td>\n",
       "      <td>5.526784</td>\n",
       "      <td>12.765462</td>\n",
       "      <td>64.000000</td>\n",
       "      <td>74.000000</td>\n",
       "      <td>12.000000</td>\n",
       "      <td>5.000000</td>\n",
       "      <td>100000.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8 rows Ã— 21 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       Total_Investment  Investment_Tenure  Average_Return  \\\n",
       "count      1.000000e+05      100000.000000   100000.000000   \n",
       "mean       6.749955e+05          11.670288        9.495579   \n",
       "std        4.913902e+05           4.955070        3.453512   \n",
       "min        4.999593e+04           1.341209        1.331471   \n",
       "25%        2.000000e+05           7.945001        6.791964   \n",
       "50%        5.000039e+05          11.005597        9.028762   \n",
       "75%        1.000000e+06          15.017276       12.039789   \n",
       "max        1.500005e+06          23.870516       18.796238   \n",
       "\n",
       "       Portfolio_Volatility  Expense_Ratio     Fund_Size  \\\n",
       "count         100000.000000  100000.000000  1.000000e+05   \n",
       "mean              19.664768       1.533243  4.333310e+06   \n",
       "std                6.576382       1.058707  2.357051e+06   \n",
       "min                6.255222      -3.010735  9.999960e+05   \n",
       "25%               14.983190       0.818927  2.000000e+06   \n",
       "50%               19.009733       1.531191  4.000004e+06   \n",
       "75%               25.003204       2.252291  6.000000e+06   \n",
       "max               34.678949       6.202026  8.000004e+06   \n",
       "\n",
       "       Sector_Allocation_Tech  Sector_Allocation_Healthcare  \\\n",
       "count           100000.000000                 100000.000000   \n",
       "mean                23.333890                     26.665730   \n",
       "std                  5.129381                      5.130522   \n",
       "min                 11.000000                     16.000000   \n",
       "25%                 20.000000                     22.000000   \n",
       "50%                 23.000000                     26.000000   \n",
       "75%                 28.000000                     30.000000   \n",
       "max                 33.000000                     39.000000   \n",
       "\n",
       "       Sector_Allocation_Finance  Sector_Allocation_RealEstate  ...  \\\n",
       "count              100000.000000                 100000.000000  ...   \n",
       "mean                   29.661060                     25.327220  ...   \n",
       "std                     6.580104                      9.917739  ...   \n",
       "min                    16.000000                      6.000000  ...   \n",
       "25%                    25.000000                     20.000000  ...   \n",
       "50%                    29.000000                     23.000000  ...   \n",
       "75%                    35.000000                     35.000000  ...   \n",
       "max                    44.000000                     44.000000  ...   \n",
       "\n",
       "       Risk_Appetite_Flag  Redemption_Frequency_Flag  Preferred_Equity_Flag  \\\n",
       "count       100000.000000              100000.000000          100000.000000   \n",
       "mean             0.491155                   0.494095               0.499359   \n",
       "std              1.118873                   1.118059               1.120324   \n",
       "min             -4.374043                  -3.833397              -4.465604   \n",
       "25%             -0.273921                  -0.267021              -0.266836   \n",
       "50%              0.494465                   0.497983               0.503598   \n",
       "75%              1.257186                   1.259966               1.260670   \n",
       "max              5.019419                   4.974001               4.979352   \n",
       "\n",
       "       Preferred_Debt_Flag  Diversification_Index  Top_3_Fund_Concentration  \\\n",
       "count        100000.000000          100000.000000             100000.000000   \n",
       "mean              0.502632               7.002951                 47.167820   \n",
       "std               1.121465               1.637176                  9.897113   \n",
       "min              -4.047726               1.197369                 26.000000   \n",
       "25%              -0.263618               5.843732                 40.000000   \n",
       "50%               0.501438               7.009824                 49.000000   \n",
       "75%               1.265504               8.160929                 55.000000   \n",
       "max               5.526784              12.765462                 64.000000   \n",
       "\n",
       "       Remaining_Fund_Allocation  Average_Holding_Period        Cluster  \\\n",
       "count              100000.000000           100000.000000  100000.000000   \n",
       "mean                   52.833680                5.505300       2.499960   \n",
       "std                     9.892496                2.003185       1.707826   \n",
       "min                    36.000000               -1.000000       0.000000   \n",
       "25%                    45.000000                4.000000       1.000000   \n",
       "50%                    51.000000                6.000000       2.000000   \n",
       "75%                    60.000000                7.000000       4.000000   \n",
       "max                    74.000000               12.000000       5.000000   \n",
       "\n",
       "         Customer_ID  \n",
       "count  100000.000000  \n",
       "mean    50000.500000  \n",
       "std     28867.657797  \n",
       "min         1.000000  \n",
       "25%     25000.750000  \n",
       "50%     50000.500000  \n",
       "75%     75000.250000  \n",
       "max    100000.000000  \n",
       "\n",
       "[8 rows x 21 columns]"
      ]
     },
     "execution_count": 52,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df2.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c0fb0f8d-b516-4bbd-b320-afaa39346b56",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
